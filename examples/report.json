{
  "run_metadata": {
    "tool_version": "0.1.0",
    "timestamp": "2026-02-25T17:47:20.897746Z",
    "command": "constraintguard score --sarif examples/vuln_demo/findings.sarif --config examples/configs/tight.yml --out examples --top-k 10",
    "source_path": null,
    "config_path": "examples/configs/tight.yml"
  },
  "hardware_spec": {
    "platform": "cortex-m4",
    "ram_size_bytes": 20480,
    "flash_size_bytes": 262144,
    "stack_size_bytes": 2048,
    "heap_size_bytes": 4096,
    "max_interrupt_latency_us": 50,
    "critical_functions": [
      "control_loop",
      "isr_uart",
      "watchdog_feed"
    ],
    "safety_level": "ISO26262-ASIL-B"
  },
  "provenance": {
    "field_origins": {
      "platform": {
        "source_type": "yaml",
        "source_path": "examples/configs/tight.yml",
        "extraction_note": null
      },
      "ram_size_bytes": {
        "source_type": "yaml",
        "source_path": "examples/configs/tight.yml",
        "extraction_note": "Parsed from 'ram_size' field"
      },
      "flash_size_bytes": {
        "source_type": "yaml",
        "source_path": "examples/configs/tight.yml",
        "extraction_note": "Parsed from 'flash_size' field"
      },
      "stack_size_bytes": {
        "source_type": "yaml",
        "source_path": "examples/configs/tight.yml",
        "extraction_note": "Parsed from 'stack_size' field"
      },
      "heap_size_bytes": {
        "source_type": "yaml",
        "source_path": "examples/configs/tight.yml",
        "extraction_note": "Parsed from 'heap_size' field"
      },
      "max_interrupt_latency_us": {
        "source_type": "yaml",
        "source_path": "examples/configs/tight.yml",
        "extraction_note": "Parsed from 'max_interrupt_latency' field"
      },
      "critical_functions": {
        "source_type": "yaml",
        "source_path": "examples/configs/tight.yml",
        "extraction_note": null
      },
      "safety_level": {
        "source_type": "yaml",
        "source_path": "examples/configs/tight.yml",
        "extraction_note": null
      }
    }
  },
  "summary": {
    "total_findings": 8,
    "tier_counts": {
      "critical": 5,
      "high": 2,
      "medium": 1,
      "low": 0
    },
    "top_findings": [
      "buffer_overflow at examples/vuln_demo/main.c:15 (score=100)",
      "null_deref at examples/vuln_demo/main.c:22 (score=100)",
      "use_after_free at examples/vuln_demo/main.c:52 (score=100)",
      "buffer_overflow at examples/vuln_demo/main.c:76 (score=100)",
      "null_deref at examples/vuln_demo/main.c:83 (score=100)",
      "integer_overflow at examples/vuln_demo/main.c:58 (score=77)",
      "leak at examples/vuln_demo/main.c:35 (score=75)",
      "uninitialized at examples/vuln_demo/main.c:69 (score=55)"
    ]
  },
  "items": [
    {
      "vulnerability": {
        "tool": "clang-sa",
        "rule_id": "security.insecureAPI.strcpy",
        "message": "Call to function 'strcpy' is insecure as it does not provide bounding of the memory buffer. Replace unbounded copy functions with analogous functions that support length arguments such as 'strlcpy'. CWE-120.",
        "path": "examples/vuln_demo/main.c",
        "start_line": 15,
        "start_col": 5,
        "function": "copy_input",
        "cwe": "CWE-120",
        "category": "buffer_overflow"
      },
      "base_score": 60,
      "final_score": 100,
      "tier": "CRITICAL",
      "rule_firings": [
        {
          "rule_id": "R-MEM-STACK-TIGHT",
          "delta": 20,
          "rationale": "Stack is tightly constrained at 2048B (≤4096B); buffer_overflow can overwrite stack frames and corrupt return addresses.",
          "constraints_used": [
            "stack_size_bytes"
          ]
        },
        {
          "rule_id": "R-MEM-RAM-TIGHT",
          "delta": 15,
          "rationale": "Total RAM is limited to 20480B (≤64KB); buffer_overflow corrupts a significant fraction of addressable memory on this device.",
          "constraints_used": [
            "ram_size_bytes"
          ]
        },
        {
          "rule_id": "R-ISR-LATENCY-OVERFLOW",
          "delta": 15,
          "rationale": "Maximum interrupt latency budget is 50µs (≤100µs); a buffer_overflow in an interrupt-sensitive code path can cause a missed real-time deadline.",
          "constraints_used": [
            "max_interrupt_latency_us"
          ]
        },
        {
          "rule_id": "R-SAFETY-ASIL-STRICT",
          "delta": 15,
          "rationale": "Safety integrity level 'ISO26262-ASIL-B' mandates deterministic memory-safe behaviour; buffer_overflow directly violates ISO 26262 ASIL freedom-from-interference requirements.",
          "constraints_used": [
            "safety_level"
          ]
        },
        {
          "rule_id": "R-SAFETY-FUNCTIONAL",
          "delta": 5,
          "rationale": "Functional safety standard 'ISO26262-ASIL-B' is declared for this target; all findings are escalated to reflect stricter acceptance criteria.",
          "constraints_used": [
            "safety_level"
          ]
        },
        {
          "rule_id": "R-TIME-ULTRA-TIGHT",
          "delta": 10,
          "rationale": "Interrupt latency budget is extremely tight at 50µs (≤50µs); findings across any execution path are escalated due to near-zero timing slack.",
          "constraints_used": [
            "max_interrupt_latency_us"
          ]
        }
      ],
      "explanation": "A buffer overflow was detected in function 'copy_input' (examples/vuln_demo/main.c:15). On your cortex-m4 / ISO26262-ASIL-B target, this corrupts adjacent memory, potentially overwriting stack frames, return addresses, or global state — on a resource-constrained embedded target, recovery may require a full device reset. This finding is escalated because: Stack is tightly constrained at 2048B (≤4096B); buffer_overflow can overwrite stack frames and corrupt return addresses; Total RAM is limited to 20480B (≤64KB); buffer_overflow corrupts a significant fraction of addressable memory on this device; Maximum interrupt latency budget is 50µs (≤100µs); a buffer_overflow in an interrupt-sensitive code path can cause a missed real-time deadline; Safety integrity level 'ISO26262-ASIL-B' mandates deterministic memory-safe behaviour; buffer_overflow directly violates ISO 26262 ASIL freedom-from-interference requirements; Functional safety standard 'ISO26262-ASIL-B' is declared for this target; all findings are escalated to reflect stricter acceptance criteria; and Interrupt latency budget is extremely tight at 50µs (≤50µs); findings across any execution path are escalated due to near-zero timing slack.",
      "remediation": "Replace unsafe memory operations with size-bounded equivalents (strncpy, snprintf, memcpy with explicit length). Validate all input lengths before copying into fixed-size buffers. On embedded targets, prefer statically-sized buffers with compile-time size assertions that enforce upper bounds. With only 2KB of stack on this target, overflows are more likely to silently corrupt adjacent frames; enable stack canaries (-fstack-protector-all) and MPU stack-guard regions if the hardware supports it.",
      "enrichment": null
    },
    {
      "vulnerability": {
        "tool": "clang-sa",
        "rule_id": "core.NullDereference",
        "message": "Dereference of null pointer (loaded from variable 'sensor_value')",
        "path": "examples/vuln_demo/main.c",
        "start_line": 22,
        "start_col": 12,
        "function": "read_sensor",
        "cwe": "CWE-476",
        "category": "null_deref"
      },
      "base_score": 50,
      "final_score": 100,
      "tier": "CRITICAL",
      "rule_firings": [
        {
          "rule_id": "R-MEM-RAM-TIGHT",
          "delta": 15,
          "rationale": "Total RAM is limited to 20480B (≤64KB); null_deref corrupts a significant fraction of addressable memory on this device.",
          "constraints_used": [
            "ram_size_bytes"
          ]
        },
        {
          "rule_id": "R-ISR-LATENCY-OVERFLOW",
          "delta": 15,
          "rationale": "Maximum interrupt latency budget is 50µs (≤100µs); a null_deref in an interrupt-sensitive code path can cause a missed real-time deadline.",
          "constraints_used": [
            "max_interrupt_latency_us"
          ]
        },
        {
          "rule_id": "R-SAFETY-ASIL-STRICT",
          "delta": 15,
          "rationale": "Safety integrity level 'ISO26262-ASIL-B' mandates deterministic memory-safe behaviour; null_deref directly violates ISO 26262 ASIL freedom-from-interference requirements.",
          "constraints_used": [
            "safety_level"
          ]
        },
        {
          "rule_id": "R-SAFETY-FUNCTIONAL",
          "delta": 5,
          "rationale": "Functional safety standard 'ISO26262-ASIL-B' is declared for this target; all findings are escalated to reflect stricter acceptance criteria.",
          "constraints_used": [
            "safety_level"
          ]
        },
        {
          "rule_id": "R-TIME-ULTRA-TIGHT",
          "delta": 10,
          "rationale": "Interrupt latency budget is extremely tight at 50µs (≤50µs); findings across any execution path are escalated due to near-zero timing slack.",
          "constraints_used": [
            "max_interrupt_latency_us"
          ]
        }
      ],
      "explanation": "A null pointer dereference was detected in function 'read_sensor' (examples/vuln_demo/main.c:22). On your cortex-m4 / ISO26262-ASIL-B target, this triggers a processor fault (e.g., ARM HardFault) that halts execution immediately — on bare-metal or RTOS targets there is typically no OS-level exception handler to recover from this. This finding is escalated because: Total RAM is limited to 20480B (≤64KB); null_deref corrupts a significant fraction of addressable memory on this device; Maximum interrupt latency budget is 50µs (≤100µs); a null_deref in an interrupt-sensitive code path can cause a missed real-time deadline; Safety integrity level 'ISO26262-ASIL-B' mandates deterministic memory-safe behaviour; null_deref directly violates ISO 26262 ASIL freedom-from-interference requirements; Functional safety standard 'ISO26262-ASIL-B' is declared for this target; all findings are escalated to reflect stricter acceptance criteria; and Interrupt latency budget is extremely tight at 50µs (≤50µs); findings across any execution path are escalated due to near-zero timing slack.",
      "remediation": "Add null-pointer guards before every pointer dereference. Use assertion macros in debug builds and explicit error-return paths in production. On bare-metal targets, a null dereference typically triggers a HardFault — ensure a fault handler is installed that logs diagnostics and performs a controlled reset. In safety-critical functions, add both a pre-condition null check and a static assertion to document and enforce the non-null invariant at compile time.",
      "enrichment": null
    },
    {
      "vulnerability": {
        "tool": "clang-sa",
        "rule_id": "unix.Malloc",
        "message": "Use of memory after it is freed",
        "path": "examples/vuln_demo/main.c",
        "start_line": 52,
        "start_col": 5,
        "function": "process_buffer",
        "cwe": "CWE-401",
        "category": "use_after_free"
      },
      "base_score": 65,
      "final_score": 100,
      "tier": "CRITICAL",
      "rule_firings": [
        {
          "rule_id": "R-MEM-STACK-TIGHT",
          "delta": 20,
          "rationale": "Stack is tightly constrained at 2048B (≤4096B); use_after_free can overwrite stack frames and corrupt return addresses.",
          "constraints_used": [
            "stack_size_bytes"
          ]
        },
        {
          "rule_id": "R-MEM-RAM-TIGHT",
          "delta": 15,
          "rationale": "Total RAM is limited to 20480B (≤64KB); use_after_free corrupts a significant fraction of addressable memory on this device.",
          "constraints_used": [
            "ram_size_bytes"
          ]
        },
        {
          "rule_id": "R-ISR-LATENCY-OVERFLOW",
          "delta": 15,
          "rationale": "Maximum interrupt latency budget is 50µs (≤100µs); a use_after_free in an interrupt-sensitive code path can cause a missed real-time deadline.",
          "constraints_used": [
            "max_interrupt_latency_us"
          ]
        },
        {
          "rule_id": "R-SAFETY-ASIL-STRICT",
          "delta": 15,
          "rationale": "Safety integrity level 'ISO26262-ASIL-B' mandates deterministic memory-safe behaviour; use_after_free directly violates ISO 26262 ASIL freedom-from-interference requirements.",
          "constraints_used": [
            "safety_level"
          ]
        },
        {
          "rule_id": "R-SAFETY-FUNCTIONAL",
          "delta": 5,
          "rationale": "Functional safety standard 'ISO26262-ASIL-B' is declared for this target; all findings are escalated to reflect stricter acceptance criteria.",
          "constraints_used": [
            "safety_level"
          ]
        },
        {
          "rule_id": "R-TIME-ULTRA-TIGHT",
          "delta": 10,
          "rationale": "Interrupt latency budget is extremely tight at 50µs (≤50µs); findings across any execution path are escalated due to near-zero timing slack.",
          "constraints_used": [
            "max_interrupt_latency_us"
          ]
        }
      ],
      "explanation": "A use-after-free was detected in function 'process_buffer' (examples/vuln_demo/main.c:52). On your cortex-m4 / ISO26262-ASIL-B target, this accesses freed memory that may have been reallocated, introducing non-deterministic behaviour — on embedded targets without full memory protection, this can silently corrupt live data structures. This finding is escalated because: Stack is tightly constrained at 2048B (≤4096B); use_after_free can overwrite stack frames and corrupt return addresses; Total RAM is limited to 20480B (≤64KB); use_after_free corrupts a significant fraction of addressable memory on this device; Maximum interrupt latency budget is 50µs (≤100µs); a use_after_free in an interrupt-sensitive code path can cause a missed real-time deadline; Safety integrity level 'ISO26262-ASIL-B' mandates deterministic memory-safe behaviour; use_after_free directly violates ISO 26262 ASIL freedom-from-interference requirements; Functional safety standard 'ISO26262-ASIL-B' is declared for this target; all findings are escalated to reflect stricter acceptance criteria; and Interrupt latency budget is extremely tight at 50µs (≤50µs); findings across any execution path are escalated due to near-zero timing slack.",
      "remediation": "Set pointers to NULL immediately after freeing. Audit all pointer copies and lifetime boundaries; prefer single-owner allocation patterns. On embedded firmware, apply MPU read-after-free detection during testing if the hardware supports memory protection. With only 2KB of stack on this target, overflows are more likely to silently corrupt adjacent frames; enable stack canaries (-fstack-protector-all) and MPU stack-guard regions if the hardware supports it.",
      "enrichment": null
    },
    {
      "vulnerability": {
        "tool": "clang-sa",
        "rule_id": "security.insecureAPI.strcpy",
        "message": "Call to function 'strcpy' is insecure as it does not provide bounding of the memory buffer. Replace unbounded copy functions with analogous functions that support length arguments such as 'strlcpy'. CWE-120.",
        "path": "examples/vuln_demo/main.c",
        "start_line": 76,
        "start_col": 5,
        "function": "isr_uart",
        "cwe": "CWE-120",
        "category": "buffer_overflow"
      },
      "base_score": 60,
      "final_score": 100,
      "tier": "CRITICAL",
      "rule_firings": [
        {
          "rule_id": "R-MEM-STACK-TIGHT",
          "delta": 20,
          "rationale": "Stack is tightly constrained at 2048B (≤4096B); buffer_overflow can overwrite stack frames and corrupt return addresses.",
          "constraints_used": [
            "stack_size_bytes"
          ]
        },
        {
          "rule_id": "R-MEM-RAM-TIGHT",
          "delta": 15,
          "rationale": "Total RAM is limited to 20480B (≤64KB); buffer_overflow corrupts a significant fraction of addressable memory on this device.",
          "constraints_used": [
            "ram_size_bytes"
          ]
        },
        {
          "rule_id": "R-ISR-FUNC-NAME",
          "delta": 25,
          "rationale": "Function 'isr_uart' matches interrupt service routine naming conventions; a fault in an ISR cannot be caught by normal exception handling and may lock the device.",
          "constraints_used": [
            "function"
          ]
        },
        {
          "rule_id": "R-ISR-LATENCY-OVERFLOW",
          "delta": 15,
          "rationale": "Maximum interrupt latency budget is 50µs (≤100µs); a buffer_overflow in an interrupt-sensitive code path can cause a missed real-time deadline.",
          "constraints_used": [
            "max_interrupt_latency_us"
          ]
        },
        {
          "rule_id": "R-CRIT-FUNC",
          "delta": 25,
          "rationale": "Function 'isr_uart' is designated safety-critical in the constraint profile; any defect in this function directly impacts controlled system operation.",
          "constraints_used": [
            "critical_functions"
          ]
        },
        {
          "rule_id": "R-SAFETY-ASIL-STRICT",
          "delta": 15,
          "rationale": "Safety integrity level 'ISO26262-ASIL-B' mandates deterministic memory-safe behaviour; buffer_overflow directly violates ISO 26262 ASIL freedom-from-interference requirements.",
          "constraints_used": [
            "safety_level"
          ]
        },
        {
          "rule_id": "R-SAFETY-FUNCTIONAL",
          "delta": 5,
          "rationale": "Functional safety standard 'ISO26262-ASIL-B' is declared for this target; all findings are escalated to reflect stricter acceptance criteria.",
          "constraints_used": [
            "safety_level"
          ]
        },
        {
          "rule_id": "R-TIME-ULTRA-TIGHT",
          "delta": 10,
          "rationale": "Interrupt latency budget is extremely tight at 50µs (≤50µs); findings across any execution path are escalated due to near-zero timing slack.",
          "constraints_used": [
            "max_interrupt_latency_us"
          ]
        }
      ],
      "explanation": "A buffer overflow was detected in function 'isr_uart' (examples/vuln_demo/main.c:76). On your cortex-m4 / ISO26262-ASIL-B target, this corrupts adjacent memory, potentially overwriting stack frames, return addresses, or global state — on a resource-constrained embedded target, recovery may require a full device reset. This finding is escalated because: Stack is tightly constrained at 2048B (≤4096B); buffer_overflow can overwrite stack frames and corrupt return addresses; Total RAM is limited to 20480B (≤64KB); buffer_overflow corrupts a significant fraction of addressable memory on this device; Function 'isr_uart' matches interrupt service routine naming conventions; a fault in an ISR cannot be caught by normal exception handling and may lock the device; Maximum interrupt latency budget is 50µs (≤100µs); a buffer_overflow in an interrupt-sensitive code path can cause a missed real-time deadline; Function 'isr_uart' is designated safety-critical in the constraint profile; any defect in this function directly impacts controlled system operation; Safety integrity level 'ISO26262-ASIL-B' mandates deterministic memory-safe behaviour; buffer_overflow directly violates ISO 26262 ASIL freedom-from-interference requirements; Functional safety standard 'ISO26262-ASIL-B' is declared for this target; all findings are escalated to reflect stricter acceptance criteria; and Interrupt latency budget is extremely tight at 50µs (≤50µs); findings across any execution path are escalated due to near-zero timing slack.",
      "remediation": "Replace unsafe memory operations with size-bounded equivalents (strncpy, snprintf, memcpy with explicit length). Validate all input lengths before copying into fixed-size buffers. On embedded targets, prefer statically-sized buffers with compile-time size assertions that enforce upper bounds. With only 2KB of stack on this target, overflows are more likely to silently corrupt adjacent frames; enable stack canaries (-fstack-protector-all) and MPU stack-guard regions if the hardware supports it.",
      "enrichment": null
    },
    {
      "vulnerability": {
        "tool": "clang-sa",
        "rule_id": "core.NullDereference",
        "message": "Dereference of null pointer (loaded from variable 'measured')",
        "path": "examples/vuln_demo/main.c",
        "start_line": 83,
        "start_col": 18,
        "function": "control_loop",
        "cwe": "CWE-476",
        "category": "null_deref"
      },
      "base_score": 50,
      "final_score": 100,
      "tier": "CRITICAL",
      "rule_firings": [
        {
          "rule_id": "R-MEM-RAM-TIGHT",
          "delta": 15,
          "rationale": "Total RAM is limited to 20480B (≤64KB); null_deref corrupts a significant fraction of addressable memory on this device.",
          "constraints_used": [
            "ram_size_bytes"
          ]
        },
        {
          "rule_id": "R-ISR-LATENCY-OVERFLOW",
          "delta": 15,
          "rationale": "Maximum interrupt latency budget is 50µs (≤100µs); a null_deref in an interrupt-sensitive code path can cause a missed real-time deadline.",
          "constraints_used": [
            "max_interrupt_latency_us"
          ]
        },
        {
          "rule_id": "R-CRIT-FUNC",
          "delta": 25,
          "rationale": "Function 'control_loop' is designated safety-critical in the constraint profile; any defect in this function directly impacts controlled system operation.",
          "constraints_used": [
            "critical_functions"
          ]
        },
        {
          "rule_id": "R-SAFETY-ASIL-STRICT",
          "delta": 15,
          "rationale": "Safety integrity level 'ISO26262-ASIL-B' mandates deterministic memory-safe behaviour; null_deref directly violates ISO 26262 ASIL freedom-from-interference requirements.",
          "constraints_used": [
            "safety_level"
          ]
        },
        {
          "rule_id": "R-SAFETY-FUNCTIONAL",
          "delta": 5,
          "rationale": "Functional safety standard 'ISO26262-ASIL-B' is declared for this target; all findings are escalated to reflect stricter acceptance criteria.",
          "constraints_used": [
            "safety_level"
          ]
        },
        {
          "rule_id": "R-TIME-ULTRA-TIGHT",
          "delta": 10,
          "rationale": "Interrupt latency budget is extremely tight at 50µs (≤50µs); findings across any execution path are escalated due to near-zero timing slack.",
          "constraints_used": [
            "max_interrupt_latency_us"
          ]
        }
      ],
      "explanation": "A null pointer dereference was detected in function 'control_loop' (examples/vuln_demo/main.c:83). On your cortex-m4 / ISO26262-ASIL-B target, this triggers a processor fault (e.g., ARM HardFault) that halts execution immediately — on bare-metal or RTOS targets there is typically no OS-level exception handler to recover from this. This finding is escalated because: Total RAM is limited to 20480B (≤64KB); null_deref corrupts a significant fraction of addressable memory on this device; Maximum interrupt latency budget is 50µs (≤100µs); a null_deref in an interrupt-sensitive code path can cause a missed real-time deadline; Function 'control_loop' is designated safety-critical in the constraint profile; any defect in this function directly impacts controlled system operation; Safety integrity level 'ISO26262-ASIL-B' mandates deterministic memory-safe behaviour; null_deref directly violates ISO 26262 ASIL freedom-from-interference requirements; Functional safety standard 'ISO26262-ASIL-B' is declared for this target; all findings are escalated to reflect stricter acceptance criteria; and Interrupt latency budget is extremely tight at 50µs (≤50µs); findings across any execution path are escalated due to near-zero timing slack.",
      "remediation": "Add null-pointer guards before every pointer dereference. Use assertion macros in debug builds and explicit error-return paths in production. On bare-metal targets, a null dereference typically triggers a HardFault — ensure a fault handler is installed that logs diagnostics and performs a controlled reset. In safety-critical functions, add both a pre-condition null check and a static assertion to document and enforce the non-null invariant at compile time.",
      "enrichment": null
    },
    {
      "vulnerability": {
        "tool": "clang-sa",
        "rule_id": "alpha.core.CastSize",
        "message": "Result of 'malloc' is converted to a pointer of type 'int *', which is incompatible with sizeof operand type 'char'. Integer overflow in implicit conversion",
        "path": "examples/vuln_demo/main.c",
        "start_line": 58,
        "start_col": 18,
        "function": "allocate_matrix",
        "cwe": "CWE-190",
        "category": "integer_overflow"
      },
      "base_score": 50,
      "final_score": 77,
      "tier": "HIGH",
      "rule_firings": [
        {
          "rule_id": "R-SAFETY-FUNCTIONAL",
          "delta": 5,
          "rationale": "Functional safety standard 'ISO26262-ASIL-B' is declared for this target; all findings are escalated to reflect stricter acceptance criteria.",
          "constraints_used": [
            "safety_level"
          ]
        },
        {
          "rule_id": "R-TIME-ULTRA-TIGHT",
          "delta": 10,
          "rationale": "Interrupt latency budget is extremely tight at 50µs (≤50µs); findings across any execution path are escalated due to near-zero timing slack.",
          "constraints_used": [
            "max_interrupt_latency_us"
          ]
        },
        {
          "rule_id": "R-SAFETY-INT-OVF",
          "delta": 12,
          "rationale": "Safety standard 'ISO26262-ASIL-B' is active; integer overflow can silently produce incorrect sensor or actuator values, violating numerical safety invariants.",
          "constraints_used": [
            "safety_level"
          ]
        }
      ],
      "explanation": "A integer overflow was detected in function 'allocate_matrix' (examples/vuln_demo/main.c:58). On your cortex-m4 / ISO26262-ASIL-B target, this silently wraps arithmetic results, producing incorrect values that propagate through control, sensor, or actuator calculations without any runtime indication. This finding is escalated because: Functional safety standard 'ISO26262-ASIL-B' is declared for this target; all findings are escalated to reflect stricter acceptance criteria; Interrupt latency budget is extremely tight at 50µs (≤50µs); findings across any execution path are escalated due to near-zero timing slack; and Safety standard 'ISO26262-ASIL-B' is active; integer overflow can silently produce incorrect sensor or actuator values, violating numerical safety invariants.",
      "remediation": "Validate arithmetic operands against their type bounds before computation. Enable UBSan (undefined behaviour sanitizer) during testing. In safety-critical paths, use checked-arithmetic macros or a safe-integer library that returns an error on overflow instead of wrapping silently. Under ISO26262-ASIL-B, apply a MISRA-compliant checked-arithmetic pattern for every arithmetic operation in the call path of this finding.",
      "enrichment": null
    },
    {
      "vulnerability": {
        "tool": "clang-sa",
        "rule_id": "unix.Malloc",
        "message": "Potential memory leak: pointer to allocated memory is not freed on all execution paths",
        "path": "examples/vuln_demo/main.c",
        "start_line": 35,
        "start_col": 22,
        "function": "build_packet",
        "cwe": "CWE-401",
        "category": "leak"
      },
      "base_score": 45,
      "final_score": 75,
      "tier": "HIGH",
      "rule_firings": [
        {
          "rule_id": "R-MEM-HEAP-TIGHT",
          "delta": 15,
          "rationale": "Heap budget is only 4096B (≤8192B); repeated memory leaks rapidly exhaust the allocation pool and trigger undefined behaviour.",
          "constraints_used": [
            "heap_size_bytes"
          ]
        },
        {
          "rule_id": "R-SAFETY-FUNCTIONAL",
          "delta": 5,
          "rationale": "Functional safety standard 'ISO26262-ASIL-B' is declared for this target; all findings are escalated to reflect stricter acceptance criteria.",
          "constraints_used": [
            "safety_level"
          ]
        },
        {
          "rule_id": "R-TIME-ULTRA-TIGHT",
          "delta": 10,
          "rationale": "Interrupt latency budget is extremely tight at 50µs (≤50µs); findings across any execution path are escalated due to near-zero timing slack.",
          "constraints_used": [
            "max_interrupt_latency_us"
          ]
        }
      ],
      "explanation": "A memory leak was detected in function 'build_packet' (examples/vuln_demo/main.c:35). On your cortex-m4 / ISO26262-ASIL-B target, this permanently consumes heap or pool memory on each call path that reaches it — on embedded targets with kilobytes of RAM, repeated leaks exhaust available memory rapidly. This finding is escalated because: Heap budget is only 4096B (≤8192B); repeated memory leaks rapidly exhaust the allocation pool and trigger undefined behaviour; Functional safety standard 'ISO26262-ASIL-B' is declared for this target; all findings are escalated to reflect stricter acceptance criteria; and Interrupt latency budget is extremely tight at 50µs (≤50µs); findings across any execution path are escalated due to near-zero timing slack.",
      "remediation": "Ensure every allocation has a corresponding free on all exit paths, including error paths. On embedded targets, consider replacing dynamic allocation with a static memory pool or arena allocator, which eliminates fragmentation and removes leak risk entirely. MISRA C Rule 21.3 prohibits dynamic memory allocation in safety-critical code. With only 4KB of heap on this target, a single recurring leak path will exhaust memory quickly; replacing all dynamic allocation with a fixed-size pool allocator is strongly recommended.",
      "enrichment": null
    },
    {
      "vulnerability": {
        "tool": "clang-sa",
        "rule_id": "core.uninitialized.UndefReturn",
        "message": "Undefined or garbage value returned to caller",
        "path": "examples/vuln_demo/main.c",
        "start_line": 69,
        "start_col": 12,
        "function": "compute_checksum",
        "cwe": "CWE-457",
        "category": "uninitialized"
      },
      "base_score": 40,
      "final_score": 55,
      "tier": "MEDIUM",
      "rule_firings": [
        {
          "rule_id": "R-SAFETY-FUNCTIONAL",
          "delta": 5,
          "rationale": "Functional safety standard 'ISO26262-ASIL-B' is declared for this target; all findings are escalated to reflect stricter acceptance criteria.",
          "constraints_used": [
            "safety_level"
          ]
        },
        {
          "rule_id": "R-TIME-ULTRA-TIGHT",
          "delta": 10,
          "rationale": "Interrupt latency budget is extremely tight at 50µs (≤50µs); findings across any execution path are escalated due to near-zero timing slack.",
          "constraints_used": [
            "max_interrupt_latency_us"
          ]
        }
      ],
      "explanation": "A uninitialized memory read was detected in function 'compute_checksum' (examples/vuln_demo/main.c:69). On your cortex-m4 / ISO26262-ASIL-B target, this reads indeterminate stack or register values, producing device-specific non-deterministic behaviour that is difficult to reproduce and may differ between debug and release builds. This finding is escalated because: Functional safety standard 'ISO26262-ASIL-B' is declared for this target; all findings are escalated to reflect stricter acceptance criteria; and Interrupt latency budget is extremely tight at 50µs (≤50µs); findings across any execution path are escalated due to near-zero timing slack.",
      "remediation": "Initialize all variables at the point of declaration. Enable -Wuninitialized and -Wmaybe-uninitialized compiler warnings and treat them as errors. In safety-critical code, zero-initialize all buffers and structs explicitly and avoid relying on BSS initialization order across translation units. Under ISO26262-ASIL-B, treat uninitialized reads as non-compliant by default and require zero-initialization of all local variables in safety-relevant translation units.",
      "enrichment": null
    }
  ]
}