{
  "run_metadata": {
    "tool_version": "0.1.0",
    "timestamp": "2026-02-25T17:05:40.941372Z",
    "command": "constraintguard run --source examples/vuln_demo --build-cmd 'make' --config examples/configs/tight.yml --out out/demo",
    "source_path": "examples/vuln_demo",
    "config_path": "examples/configs/tight.yml"
  },
  "hardware_spec": {
    "platform": "cortex-m4",
    "ram_size_bytes": 20480,
    "flash_size_bytes": 262144,
    "stack_size_bytes": 2048,
    "heap_size_bytes": 4096,
    "max_interrupt_latency_us": 50,
    "critical_functions": [
      "control_loop",
      "isr_uart"
    ],
    "safety_level": "ISO26262-ASIL-B"
  },
  "provenance": {
    "field_origins": {
      "ram_size_bytes": {
        "source_type": "yaml",
        "source_path": "examples/configs/tight.yml",
        "extraction_note": null
      },
      "flash_size_bytes": {
        "source_type": "yaml",
        "source_path": "examples/configs/tight.yml",
        "extraction_note": null
      },
      "stack_size_bytes": {
        "source_type": "ld",
        "source_path": "examples/vuln_demo/linker.ld",
        "extraction_note": "Extracted from _stack_size symbol"
      },
      "heap_size_bytes": {
        "source_type": "yaml",
        "source_path": "examples/configs/tight.yml",
        "extraction_note": null
      },
      "safety_level": {
        "source_type": "yaml",
        "source_path": "examples/configs/tight.yml",
        "extraction_note": null
      },
      "critical_functions": {
        "source_type": "yaml",
        "source_path": "examples/configs/tight.yml",
        "extraction_note": null
      },
      "max_interrupt_latency_us": {
        "source_type": "yaml",
        "source_path": "examples/configs/tight.yml",
        "extraction_note": null
      }
    }
  },
  "summary": {
    "total_findings": 3,
    "tier_counts": {
      "critical": 2,
      "high": 1,
      "medium": 0,
      "low": 0
    },
    "top_findings": [
      "core.NullDereference",
      "core.StackAddressEscape",
      "unix.Malloc"
    ]
  },
  "items": [
    {
      "vulnerability": {
        "tool": "clang-sa",
        "rule_id": "core.NullDereference",
        "message": "Dereference of null pointer",
        "path": "src/control.c",
        "start_line": 85,
        "start_col": 3,
        "function": "control_loop",
        "cwe": "CWE-476",
        "category": "null-dereference"
      },
      "base_score": 55,
      "final_score": 92,
      "tier": "CRITICAL",
      "rule_firings": [
        {
          "rule_id": "critical-function-hit",
          "delta": 25,
          "rationale": "Null dereference in critical function 'control_loop'",
          "constraints_used": [
            "critical_functions"
          ]
        },
        {
          "rule_id": "safety-critical-context",
          "delta": 8,
          "rationale": "Finding in safety-critical context (ISO26262-ASIL-B)",
          "constraints_used": [
            "safety_level"
          ]
        },
        {
          "rule_id": "interrupt-latency-risk",
          "delta": 4,
          "rationale": "Crash in control path may violate 50us interrupt latency budget",
          "constraints_used": [
            "max_interrupt_latency_us"
          ]
        }
      ],
      "explanation": "Null dereference in control_loop is critical: this is a marked critical function under ISO26262-ASIL-B with a 50us interrupt latency budget.",
      "remediation": "Add null checks before dereferencing pointers in control_loop. Consider using defensive coding patterns required by ASIL-B.",
      "enrichment": null
    },
    {
      "vulnerability": {
        "tool": "clang-sa",
        "rule_id": "core.StackAddressEscape",
        "message": "Address of stack memory associated with local variable 'buf' returned to caller",
        "path": "src/comm.c",
        "start_line": 42,
        "start_col": 5,
        "function": "send_response",
        "cwe": "CWE-562",
        "category": "stack-overflow"
      },
      "base_score": 60,
      "final_score": 88,
      "tier": "CRITICAL",
      "rule_firings": [
        {
          "rule_id": "mem-tight-stack-overflow",
          "delta": 20,
          "rationale": "Stack overflow risk escalated: stack budget is 2048 bytes",
          "constraints_used": [
            "stack_size_bytes"
          ]
        },
        {
          "rule_id": "safety-critical-context",
          "delta": 8,
          "rationale": "Finding in safety-critical context (ISO26262-ASIL-B)",
          "constraints_used": [
            "safety_level"
          ]
        }
      ],
      "explanation": "Stack address escape in send_response is critical under a 2KB stack budget. Safety context ISO26262-ASIL-B further escalates this finding.",
      "remediation": "Avoid returning pointers to stack-allocated buffers. Use a caller-provided buffer or a statically allocated region.",
      "enrichment": null
    },
    {
      "vulnerability": {
        "tool": "clang-sa",
        "rule_id": "unix.Malloc",
        "message": "Potential memory leak",
        "path": "src/sensor.c",
        "start_line": 118,
        "start_col": 12,
        "function": "read_sensor_data",
        "cwe": "CWE-401",
        "category": "memory-leak"
      },
      "base_score": 50,
      "final_score": 72,
      "tier": "HIGH",
      "rule_firings": [
        {
          "rule_id": "mem-tight-heap-leak",
          "delta": 15,
          "rationale": "Memory leak escalated: heap budget is 4096 bytes",
          "constraints_used": [
            "heap_size_bytes"
          ]
        },
        {
          "rule_id": "ram-pressure",
          "delta": 7,
          "rationale": "RAM is constrained to 20480 bytes; leaks exhaust available memory faster",
          "constraints_used": [
            "ram_size_bytes"
          ]
        }
      ],
      "explanation": "Memory leak in read_sensor_data is high-risk under a 4KB heap budget with only 20KB total RAM.",
      "remediation": "Ensure all allocated memory is freed on every code path. Consider using a pool allocator sized to the heap budget.",
      "enrichment": null
    }
  ]
}